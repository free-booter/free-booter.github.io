# script 标签中 defer 和 async 的区别

## 为什么需要这 2 个属性？

当 JS 文件较大或较多时，直接在页面中加载会阻塞 HTML 的解析。`defer` 和 `async` 属性可以优化脚本的加载方式，提升页面性能和用户体验。

## async

- **加载方式**：异步加载 JS 文件，不阻塞 HTML 解析。
- **执行时机**：文件下载完成后立即执行，**不保证执行顺序**。
- **适用场景**：多个脚本之间没有依赖关系时使用。

```html
<script src="a.js" async></script>
<script src="b.js" async></script>
```

> a.js 和 b.js 会并行下载，哪个先下载完就先执行。

## defer

- **加载方式**：异步加载 JS 文件，不阻塞 HTML 解析。
- **执行时机**：HTML 解析完成后，按顺序依次执行所有带 defer 的脚本。
- **适用场景**：多个脚本之间有依赖关系，或需要在 DOM 加载完毕后执行。

```html
<script src="a.js" defer></script>
<script src="b.js" defer></script>
```

> a.js 和 b.js 会并行下载，但会在 DOM 解析完成后，按顺序执行。

## 总结

| 属性  | 加载方式 | 执行时机         | 执行顺序 | 是否阻塞解析 |
| ----- | -------- | ---------------- | -------- | ------------ |
| async | 异步     | 下载完成立即执行 | 不保证   | 否           |
| defer | 异步     | DOM 解析后执行   | 保证     | 否           |

> 推荐：如果脚本之间有依赖，使用 defer；无依赖且不关心顺序
